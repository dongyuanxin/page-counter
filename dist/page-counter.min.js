!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e){e.exports={name:"page-counter",version:"1.3.4",description:"基于Serverless开发的的极简网页计数器，支持基于Hexo、Jekyll、Octopress、ReactJS、VueJS等框架开发的博客、网站、中后台等任何应用。",main:"index.js",scripts:{dev:"webpack-dev-server --env development --open --config build/webpack.base.conf.js",build:"webpack --env production --config build/webpack.base.conf.js",test:'echo "Error: no test specified" && exit 1'},repository:{type:"git",url:"git+ssh://git@github.com/dongyuanxin/page-counter.git"},keywords:["pv","counter","blog","serverless","analysis","es6"],author:"DongYuanxin",license:"MIT",bugs:{url:"https://github.com/dongyuanxin/page-counter/issues"},homepage:"https://godbmw.com/page-counter/",devDependencies:{"html-webpack-plugin":"^3.2.0",mysql:"^2.17.1",webpack:"^4.30.0","webpack-cli":"^3.3.2","webpack-dev-server":"^3.3.1","webpack-merge":"^4.2.1"},dependencies:{"hydrogen-js-sdk":"^1.6.7","leancloud-storage":"^3.13.1"}}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return e<10?"0"+e:e+""}function a(){const e=new Date;return e.now=e.getTime()+"",e.format=(()=>{return`${o(e.getFullYear())}/${o(e.getMonth()+1)}/${o(e.getDate())} ${o(e.getHours())}:${o(e.getMinutes())}:${o(e.getSeconds())}`}),e}function s(e){return(e=e.trim()).startsWith("/")||(e=`/${e}`),e.endsWith("/")||(e=`${e}/`),e}function i(e,t){if(!e||!t)return!1;for(let r of t){const{key:t,required:n,type:o,defaultValue:a,prompt:s}=r;if(n){if(!e.hasOwnProperty(t))return[!1,s||""];if(o&&typeof e[t]!==o)return[!1,s||""]}else!e[t]&&(e[t]=a)}return[!0]}const u=[{key:"table",type:"string",required:!0,prompt:"Please input leancloud table name"},{key:"appId",type:"string",required:!0,prompt:"Please input leancloud appId"},{key:"appKey",type:"string",required:!0,prompt:"Please input leancloud appKey"},{key:"history",type:"number",required:!1,defaultValue:0}],c=[{key:"table",type:"string",required:!0,prompt:"Please input bomb table name"},{key:"appId",type:"string",required:!0,prompt:"Please input bomb appId"},{key:"restApi",type:"string",required:!0,prompt:"Please input bomb restApi"},{key:"history",type:"number",required:!1,defaultValue:0}];var l=new class{constructor(){}get serverless(){if(!window.PAGE_COUNTER_CONFIG)throw new Error("Please init variable window.PAGE_COUNTER_CONFIG");return window.PAGE_COUNTER_CONFIG.serverless||"leancloud"}get AV(){if(!window.AV)throw new Error("Please import leancloud-storage sdk");return window.AV}get Bomb(){if(!window.Bmob)throw new Error("Please import hydrogen sdk");return window.Bomb}get leancloud(){if(!window.PAGE_COUNTER_CONFIG)throw new Error("Please init variable window.PAGE_COUNTER_CONFIG");const{leancloud:e}=window.PAGE_COUNTER_CONFIG,[t,r]=i(e,u);if(!t)throw new Error(r);return e}get bomb(){if(!window.PAGE_COUNTER_CONFIG)throw new Error("Please init variable window.PAGE_COUNTER_CONFIG");const{bomb:e}=window.PAGE_COUNTER_CONFIG,[t,r]=i(e,c);if(!t)throw new Error(r);return e}};class p{constructor(){}ACL(){throw new Error('Interface method "ACL" must be rewritten')}setData(){throw new Error('Interface method "setData" must be rewritten')}count(){throw new Error('Interface method "count" must be rewritten')}}var d=class extends p{constructor(){super();const{leancloud:{appId:e,appKey:t},AV:r}=l;r.init({appId:e,appKey:t}),this.AV=r}ACL(){const e=new this.AV.ACL;return e.setPublicReadAccess(!0),e.setPublicWriteAccess(!1),e}async setData(e,t){const r=new(this.AV.Object.extend(e));for(let e of Reflect.ownKeys(t))r.set(e,t[e]);r.setACL(this.ACL());try{return await r.save(),!0}catch(e){return!1}}async count(e,t){const r=new this.AV.Query(e);"string"==typeof t&&t.length>0&&r.equalTo("URL",t);try{return await r.count()}catch(e){return 0}}};var w=class extends p{constructor(){super();const{Bomb:e,bomb:{appId:t,restApi:r}}=l;e.initialize(t,r)}ACL(){return{"*":{read:!0}}}async setData(e,t){const{Bomb:r}=l,n=Bmob.Query(e);for(let e of Reflect.ownKeys(t))n.set(e,t[e]);n.set("ACL",this.ACL());try{return await n.save(),!0}catch(e){return!1}}async count(e,t){const{Bomb:r}=l,n=Bmob.Query(e);"string"==typeof t&&t.length>0&&n.equalTo("URL","==",t);try{return await n.count()}catch(e){return 0}}};var b=class{constructor(e){switch(e=e.toLocaleLowerCase()){case"leancloud":return new d;case"bomb":return new w;default:throw new Error("Serverless must be one of [ leancloud, bomb ]")}}};console.log(`\n%c ${n.name} v${n.version} %c`+` ${n.homepage} \n`,"color: #fadfa3; background: #030307; padding:3px 0;","");const f=l.serverless,y=new b(f);var m={setData:async function(){const e=new a,t={URL:s(window.location.pathname||""),UserAgent:window.navigator.userAgent,CreateTime:e.format(),CreateTimeStamp:e.now};y.setData(l[f].table,t)},countTotal:async function(){const e=document.querySelector("#page-counter-total-times");if(!e)return;const t=await y.count(l[f].table);e.innerHTML=t+l[f].history},countSingle:async function(){const e=document.querySelector("#page-counter-single-times");if(!e)return;const t=await y.count(l[f].table,s(window.location.pathname||""));e.innerHTML=t}};m.setData(),m.countTotal(),m.countSingle()}]);