!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function r(e){return e<10?"0"+e:e+""}function o(){const e=new Date;return e.now=e.getTime()+"",e.format=(()=>{return`${r(e.getFullYear())}/${r(e.getMonth()+1)}/${r(e.getDate())} ${r(e.getHours())}:${r(e.getMinutes())}:${r(e.getSeconds())}`}),e}function a(e){return(e=e.trim()).startsWith("/")||(e=`/${e}`),e.endsWith("/")||(e=`${e}/`),e}function i(e,t){if(!e||!t)return!1;for(let n of t){const{key:t,required:r,type:o,defaultValue:a,prompt:i}=n;if(r){if(!e.hasOwnProperty(t))return[!1,i||""];if(o&&typeof e[t]!==o)return[!1,i||""]}else!e[t]&&(e[t]=a)}return[!0]}n.r(t);const u=[{key:"table",type:"string",required:!0,prompt:"Please input leancloud table name"},{key:"appId",type:"string",required:!0,prompt:"Please input leancloud appId"},{key:"appKey",type:"string",required:!0,prompt:"Please input leancloud appKey"},{key:"history",type:"number",required:!1,defaultValue:0}],s=[{key:"table",type:"string",required:!0,prompt:"Please input bomb table name"},{key:"appId",type:"string",required:!0,prompt:"Please input bomb appId"},{key:"restApi",type:"string",required:!0,prompt:"Please input bomb restApi"},{key:"history",type:"number",required:!1,defaultValue:0}];var c=new class{constructor(){}get serverless(){if(!window.PAGE_COUNTER_CONFIG)throw new Error("Please init variable window.PAGE_COUNTER_CONFIG");return window.PAGE_COUNTER_CONFIG.serverless||"leancloud"}get AV(){if(!window.AV)throw new Error("Please import leancloud-storage sdk");return window.AV}get Bomb(){if(!window.Bmob)throw new Error("Please import hydrogen sdk");return window.Bomb}get leancloud(){if(!window.PAGE_COUNTER_CONFIG)throw new Error("Please init variable window.PAGE_COUNTER_CONFIG");const{leancloud:e}=window.PAGE_COUNTER_CONFIG,[t,n]=i(e,u);if(!t)throw new Error(n);return e}get bomb(){if(!window.PAGE_COUNTER_CONFIG)throw new Error("Please init variable window.PAGE_COUNTER_CONFIG");const{bomb:e}=window.PAGE_COUNTER_CONFIG,[t,n]=i(e,s);if(!t)throw new Error(n);return e}};function l(){const{leancloud:e,AV:t}=c;t.init({appId:e.appId,appKey:e.appKey})}l.prototype.ACL=function(){const e=new AV.ACL;return e.setPublicReadAccess(!0),e.setPublicWriteAccess(!1),e},l.prototype.setData=async function(e,t){const n=new(AV.Object.extend(e));for(let e of Reflect.ownKeys(t))n.set(e,t[e]);n.setACL(this.ACL());try{return await n.save(),!0}catch(e){return!1}},l.prototype.count=async function(e,t){const n=new AV.Query(e);"string"==typeof t&&t.length>0&&n.equalTo("URL",t);try{return await n.count()}catch(e){return 0}};var p=l;function f(){const{Bomb:e,bomb:{appId:t,restApi:n}}=c;e.initialize(t,n)}f.prototype.ACL=function(){return{"*":{read:!0}}},f.prototype.setData=async function(e,t){const n=Bmob.Query(e);for(let e of Reflect.ownKeys(t))n.set(e,t[e]);n.set("ACL",this.ACL());try{return await n.save(),!0}catch(e){return!1}},f.prototype.count=async function(e,t){const n=Bmob.Query(e);"string"==typeof t&&t.length>0&&n.equalTo("URL","==",t);try{return await n.count()}catch(e){return 0}};var d=f;var w=function(e){switch(e=e.toLocaleLowerCase()){case"leancloud":return new p;case"bomb":return new d;default:throw new Error("Serverless must be one of [leancloud]")}};const y=c.serverless,b=new w(y);var m={setData:async function(){const e=new o,t={URL:a(window.location.pathname||""),UserAgent:window.navigator.userAgent,CreateTime:e.format(),CreateTimeStamp:e.now};b.setData(c[y].table,t)},countTotal:async function(){const e=document.querySelector("#page-counter-total-times");if(!e)return;const t=await b.count(c[y].table);e.innerHTML=t+c[y].history},countSingle:async function(){const e=document.querySelector("#page-counter-single-times");if(!e)return;const t=await b.count(c[y].table,a(window.location.pathname||""));e.innerHTML=t}};m.setData(),m.countTotal(),m.countSingle()}]);